# Vulnerability Management Skill - Master Plan

**Skill Name:** `vulnerability-management`
**Skill Level:** Mid Level (5,000-8,000 tokens)
**Status:** Planning Phase (init.md complete, SKILL.md to be created)
**Last Updated:** December 3, 2025

---

## Table of Contents

1. [Strategic Positioning](#strategic-positioning)
2. [Skill Purpose and Scope](#skill-purpose-and-scope)
3. [Research Findings](#research-findings)
4. [Vulnerability Management Taxonomy](#vulnerability-management-taxonomy)
5. [Decision Frameworks](#decision-frameworks)
6. [Scanning Tool Implementations](#scanning-tool-implementations)
7. [SBOM Patterns](#sbom-patterns)
8. [Vulnerability Prioritization](#vulnerability-prioritization)
9. [Implementation Patterns](#implementation-patterns)
10. [Tool Recommendations](#tool-recommendations)
11. [Skill Structure Design](#skill-structure-design)
12. [Integration Points](#integration-points)
13. [Implementation Roadmap](#implementation-roadmap)

---

## Strategic Positioning

### Why This Skill Matters

Vulnerability management is the cornerstone of secure software delivery in 2025. With software supply chain attacks surging and regulatory requirements intensifying (SBOM mandates, Executive Order 14028), organizations must embed vulnerability detection and remediation throughout the development lifecycle.

**Market Drivers:**

- **Supply Chain Security:** Software supply chain attacks increased 650% in 2024 (source: Sonatype)
- **SBOM Mandates:** Federal requirements (EO 14028) and industry standards (NTIA minimum elements)
- **Shift-Left Security:** Vulnerability detection moving into CI/CD pipelines
- **Container Proliferation:** 75% of enterprises using containers in production
- **DevSecOps Maturity:** Security as code, automated scanning, continuous monitoring

**Strategic Value:**

1. **Risk Reduction:** Early vulnerability detection reduces remediation cost by 100x
2. **Compliance:** SBOM generation for regulatory requirements and customer audits
3. **Speed to Market:** Automated scanning enables fast, secure deployments
4. **Supply Chain Transparency:** Complete visibility into dependencies and risks

### How This Differs from Existing Solutions

**Existing Vulnerability Documentation:**

- **Tool-Specific:** Trivy docs, Snyk docs, Grype docs (siloed knowledge)
- **Tactical Focus:** "How to run a scan" vs. "When to use what tool"
- **Limited Integration:** Doesn't cover full CI/CD integration patterns
- **Single-Layer:** Container scanning OR SAST OR DAST, not unified

**Our Approach:**

- **Unified Strategy:** Multi-layer scanning (container, SAST, DAST, SCA, secrets)
- **Decision Frameworks:** Which tool for which use case, prioritization strategies
- **CI/CD Integration Patterns:** GitHub Actions, GitLab CI, Jenkins examples
- **Prioritization Models:** CVSS, EPSS, KEV catalog integration
- **SBOM-First:** CycloneDX and SPDX generation, management, and consumption
- **Remediation Workflows:** SLA tracking, false positive management, metrics

### Target Audience

**Primary Users:**

- DevSecOps engineers implementing security pipelines
- Platform engineers building CI/CD infrastructure
- Security teams establishing vulnerability management programs
- Developers integrating security scanning into workflows

**Skill Level Assumptions:**

- Understands CI/CD concepts (pipelines, artifacts, stages)
- Familiar with containers and Docker
- Basic knowledge of CVEs and vulnerability severity
- Understands YAML configuration files

---

## Skill Purpose and Scope

### What This Skill Teaches

**Core Competencies:**

1. **Multi-Layer Scanning Strategy**
   - Container image scanning (Trivy, Grype, Snyk Container)
   - SAST (Static Application Security Testing) integration
   - DAST (Dynamic Application Security Testing) patterns
   - SCA (Software Composition Analysis) for dependencies
   - Secret scanning and prevention

2. **SBOM Generation and Management**
   - CycloneDX vs. SPDX format selection
   - Automated SBOM generation in CI/CD
   - SBOM storage and distribution
   - SBOM consumption for vulnerability analysis

3. **Vulnerability Prioritization**
   - CVSS scoring (base, temporal, environmental)
   - EPSS (Exploit Prediction Scoring System) integration
   - KEV (Known Exploited Vulnerabilities) catalog
   - Business context and risk-based prioritization

4. **Remediation Workflows**
   - SLA-based remediation (Critical: 7 days, High: 30 days, etc.)
   - False positive management and suppression
   - Automated PR creation for dependency updates
   - Vulnerability tracking and metrics

5. **CI/CD Security Gates**
   - Fail build on critical vulnerabilities
   - Quality gates and thresholds
   - Baseline scanning and drift detection
   - Policy-as-code for vulnerability management

### What This Skill Does NOT Cover

**Out of Scope:**

- **Penetration Testing:** Manual security testing (separate discipline)
- **Security Architecture Design:** System design patterns (see `security-architecture` skill)
- **Compliance Frameworks:** Mapping to SOC2, ISO 27001 (see `compliance-frameworks` skill)
- **Incident Response:** Handling active security incidents (see `incident-management` skill)
- **Runtime Protection:** RASP, WAF, runtime monitoring (see `observability` skill)
- **Secret Management:** Vault, KMS, secret rotation (see `secret-management` skill)

### Success Criteria

**A user successfully uses this skill when they can:**

1. Select appropriate scanning tools for different layers (container, code, dependencies)
2. Generate SBOMs in CycloneDX or SPDX format
3. Integrate vulnerability scanning into CI/CD pipelines
4. Prioritize vulnerabilities using CVSS, EPSS, and KEV
5. Implement security gates that fail builds on critical findings
6. Track vulnerability remediation with SLAs and metrics
7. Manage false positives and suppression rules
8. Generate vulnerability reports for compliance and audits

---

## Research Findings

### Research Date: December 3, 2025

**Research Tools Used:**

- Google Search Grounding (Vertex AI) - 3 queries completed
- Context7 for library documentation (Trivy, Grype)
- Official documentation review

### Key Trends for 2025

**1. Container Scanning Maturity**

- **Open-Source Leaders:** Trivy and Grype dominate open-source container scanning
- **Trivy Adoption:** 10M+ downloads/month, comprehensive coverage (OS packages, language packages, secrets, misconfigurations)
- **Grype Strengths:** Accuracy-focused, minimal false positives, Syft integration for SBOM generation
- **Snyk Container:** Developer-first, excellent CI/CD integration, shift-left focus
- **Critical CVE:** Grype credential disclosure vulnerability (CVE-2025-65965) patched in v0.104.1

**2. SBOM as Standard Practice**

- **CycloneDX vs. SPDX:**
  - **CycloneDX:** Security-focused, OWASP-maintained, fast automated environments, JSON/XML/ProtoBuf
  - **SPDX:** License compliance focus, ISO standard (ISO/IEC 5962:2021), comprehensive legal metadata
  - **Recommendation:** CycloneDX for DevSecOps, SPDX for compliance/legal teams
- **NTIA Minimum Elements:** Supplier, component name, version, unique identifier, dependency relationships, author, timestamp
- **Automated Generation:** CI/CD integration mandatory, generate on every build
- **SBOM Management Platforms:** Kusari, Sonatype SBOM Manager, Dependency Track

**3. SAST/DAST Evolution**

- **AI-Powered Analysis:** ML-driven vulnerability detection, automated triage, exploitability prediction
- **Unified Platforms:** GitLab Ultimate, Snyk (SCA + SAST + Container + IaC), Checkmarx
- **Developer-First:** Shift-left tools (Semgrep, Snyk Code) integrated into IDEs and PR reviews
- **SAST Strengths:** Early detection, code-level fixes, hidden vulnerability discovery
- **DAST Strengths:** Runtime issues, authentication/business logic flaws, real-world attack simulation

**4. Vulnerability Prioritization Sophistication**

- **CVSS Limitations:** Base score alone insufficient, doesn't reflect actual risk
- **EPSS Integration:** Exploit Prediction Scoring System predicts exploitation probability
- **KEV Catalog:** CISA Known Exploited Vulnerabilities - actively exploited CVEs requiring immediate action
- **Risk-Based Prioritization:** Combine CVSS + EPSS + KEV + business context + asset criticality
- **Modern Approach:** Focus on exploitable vulnerabilities in production-exposed assets first

**5. DevSecOps Integration**

- **Security as Code:** Policy-as-code (OPA, Rego), automated enforcement
- **CI/CD Native:** Scanning integrated into every pipeline stage
- **Fast Feedback:** Unit-test-like experience for security (fail fast, clear errors)
- **Developer Ownership:** Developers fix vulnerabilities, security teams provide tooling and policy

---

## Vulnerability Management Taxonomy

### Layer 1: Container Image Scanning

**Purpose:** Detect vulnerabilities in container images (OS packages, language dependencies, binaries)

**Tools:**

- **Trivy** (Comprehensive, fast, open-source)
- **Grype** (Accuracy-focused, Syft integration)
- **Snyk Container** (Developer-first, commercial)

**What's Scanned:**

- OS packages (Alpine, Debian, Ubuntu, RHEL, etc.)
- Language packages (npm, pip, gem, Maven, Gradle, Go modules)
- Application binaries (non-packaged executables)
- Secrets (API keys, passwords, tokens)
- Misconfigurations (Dockerfile best practices, Kubernetes manifests)

**When to Use:**

- Every container image before deployment
- Base image selection (alpine:3.19 vs. ubuntu:22.04)
- Third-party image validation (public registries)
- Registry admission control (prevent vulnerable images)

---

### Layer 2: SAST (Static Application Security Testing)

**Purpose:** Analyze source code for security vulnerabilities before runtime

**Tools:**

- **Semgrep** (Fast, semantic pattern matching, open-source)
- **Snyk Code** (Developer-focused, IDE integration)
- **SonarQube** (Code quality + security, enterprise)
- **GitLab SAST** (Native CI/CD integration)

**What's Detected:**

- Injection flaws (SQL injection, XSS, command injection)
- Authentication/authorization issues
- Sensitive data exposure
- Security misconfigurations
- Insecure deserialization
- Hardcoded secrets

**When to Use:**

- Every commit (pre-commit hooks or PR checks)
- Main branch protection (prevent vulnerable code merges)
- Custom application code (not dependencies)
- Compliance requirements (OWASP Top 10 coverage)

---

### Layer 3: DAST (Dynamic Application Security Testing)

**Purpose:** Test running applications for vulnerabilities (black-box testing)

**Tools:**

- **OWASP ZAP** (Open-source, full-featured)
- **StackHawk** (Modern DAST, CI/CD native)
- **Burp Suite** (Manual + automated, security researcher favorite)

**What's Detected:**

- Authentication bypasses
- Business logic flaws
- API security issues
- Session management vulnerabilities
- Configuration issues (CORS, CSP, headers)
- Injection vulnerabilities (in runtime context)

**When to Use:**

- Staging environment testing (before production)
- API endpoint validation
- Authentication flow testing
- Critical application updates
- Regular security scanning (weekly/monthly)

---

### Layer 4: SCA (Software Composition Analysis)

**Purpose:** Analyze third-party dependencies for known vulnerabilities

**Tools:**

- **Snyk Open Source** (Largest vulnerability database)
- **Dependabot** (GitHub native, automated PRs)
- **Renovate** (Advanced dependency updates)
- **OWASP Dependency-Check** (Open-source)

**What's Detected:**

- Vulnerable dependency versions
- License compliance issues
- Outdated dependencies with security fixes
- Transitive dependency vulnerabilities
- Supply chain risks

**When to Use:**

- Every build (continuous monitoring)
- Dependency updates (automated PR reviews)
- License audits
- New project setup (establish baseline)
- Third-party library evaluation

---

### Layer 5: Secret Scanning

**Purpose:** Prevent secrets from being committed to source code

**Tools:**

- **GitGuardian** (Real-time scanning, incident response)
- **TruffleHog** (Open-source, regex + entropy detection)
- **Gitleaks** (Fast, configurable, open-source)
- **GitHub Secret Scanning** (Native, automatic)

**What's Detected:**

- API keys and tokens
- Passwords and credentials
- Private keys and certificates
- Cloud access keys (AWS, GCP, Azure)
- Database connection strings
- OAuth tokens

**When to Use:**

- Pre-commit hooks (prevent secrets from being committed)
- Repository scanning (detect historical leaks)
- CI/CD pipelines (catch secrets in artifacts)
- Regular audits (periodic repository scans)

---

## Decision Frameworks

### Framework 1: Which Scanning Tool Should I Use?

**Decision Tree:**

```
START: I need to scan [artifact type]

Q1: What am I scanning?
  ├─ Container Image → Q2
  ├─ Source Code → Q3
  ├─ Running Application → Q4
  ├─ Dependencies (package.json, requirements.txt) → Q5
  └─ Git Repository → Q6

Q2: Container Image Scanning
  ├─ Need comprehensive coverage (OS + languages + secrets + misconfig)?
  │   └─ YES → Trivy (fastest, most comprehensive)
  ├─ Need accuracy with minimal false positives?
  │   └─ YES → Grype (with Syft for SBOM)
  └─ Need developer-first experience with CI/CD integration?
      └─ YES → Snyk Container (commercial)

Q3: Source Code Scanning (SAST)
  ├─ Need fast, customizable rules?
  │   └─ YES → Semgrep (open-source, semantic matching)
  ├─ Need IDE integration with developer guidance?
  │   └─ YES → Snyk Code (commercial)
  └─ Need enterprise code quality + security?
      └─ YES → SonarQube (commercial)

Q4: Running Application (DAST)
  ├─ Need open-source full-featured scanner?
  │   └─ YES → OWASP ZAP
  ├─ Need modern CI/CD native DAST?
  │   └─ YES → StackHawk
  └─ Need manual testing + automation?
      └─ YES → Burp Suite

Q5: Dependency Scanning (SCA)
  ├─ Using GitHub?
  │   └─ YES → Dependabot (native, free)
  ├─ Need advanced automation and customization?
  │   └─ YES → Renovate (open-source, powerful)
  └─ Need comprehensive commercial solution?
      └─ YES → Snyk Open Source

Q6: Secret Scanning
  ├─ Need real-time protection with incident response?
  │   └─ YES → GitGuardian (commercial)
  ├─ Need open-source with custom rules?
  │   └─ YES → Gitleaks or TruffleHog
  └─ Using GitHub?
      └─ YES → GitHub Secret Scanning (native)
```

---

### Framework 2: SBOM Format Selection

**CycloneDX vs. SPDX Decision Matrix:**

| Criterion | CycloneDX | SPDX | Recommendation |
|-----------|-----------|------|----------------|
| **Primary Focus** | Security & vulnerability analysis | License compliance & legal | CycloneDX for DevSecOps, SPDX for legal |
| **Format Options** | JSON, XML, Protocol Buffers | JSON, XML, YAML, RDF, Tag/Value | CycloneDX: JSON (fastest), SPDX: choose based on tooling |
| **Maintainer** | OWASP (security community) | Linux Foundation (ISO standard) | CycloneDX: agile, SPDX: stable |
| **Vulnerability Data** | Native vulnerability references | Limited, external enrichment needed | CycloneDX if vulnerability tracking critical |
| **License Compliance** | Basic license data | Comprehensive license metadata | SPDX if license compliance primary concern |
| **Tool Support** | Trivy, Syft, cdxgen, Grype | Tern, Microsoft SBOM Tool, Syft | Both well-supported |
| **CI/CD Integration** | Fast, lightweight (JSON) | Heavier (more comprehensive) | CycloneDX for automated pipelines |
| **Regulatory** | NTIA compliant | ISO standard (ISO/IEC 5962:2021) | SPDX if ISO compliance required |

**Recommendation by Use Case:**

- **DevSecOps/Security:** CycloneDX (security-focused, fast, OWASP-maintained)
- **Legal/Compliance:** SPDX (comprehensive license data, ISO standard)
- **Dual Requirements:** Generate both (Syft supports both formats)
- **Federal/Defense:** SPDX (ISO standard aligns with government requirements)
- **Startups/Agile Teams:** CycloneDX (faster, easier, security-first)

**Best Practice:** Start with CycloneDX for security pipelines, add SPDX for legal/compliance teams if needed.

---

### Framework 3: Vulnerability Prioritization

**Modern Risk-Based Prioritization (2025 Best Practice):**

**Step 1: Gather Data**

| Metric | Source | Purpose |
|--------|--------|---------|
| **CVSS Base Score** | NVD, vendor advisories | Vulnerability severity (0-10) |
| **EPSS Score** | FIRST.org EPSS API | Exploitation probability (0-1) |
| **KEV Status** | CISA KEV Catalog | Actively exploited in the wild |
| **Asset Criticality** | Internal CMDB | Business impact if compromised |
| **Exposure** | Network topology | Internet-facing vs. internal |
| **Exploitability** | PoC availability, ease of exploit | Likelihood of successful attack |

**Step 2: Calculate Priority Score**

**Formula (Weighted Risk Score):**

```
Priority Score = (CVSS × 0.3) + (EPSS × 100 × 0.3) + (KEV × 50) + (Asset × 0.2) + (Exposure × 0.2)

Where:
- CVSS: Base score (0-10)
- EPSS: Probability (0-1), scaled to 0-100
- KEV: 1 if in KEV catalog, 0 otherwise
- Asset: 1 (Critical), 0.7 (High), 0.4 (Medium), 0.1 (Low)
- Exposure: 1 (Internet-facing), 0.5 (Internal), 0.1 (Isolated)
```

**Step 3: Prioritization Tiers**

| Priority | Criteria | SLA | Action |
|----------|----------|-----|--------|
| **P0 - Critical** | KEV + Internet-facing + Critical asset | 24 hours | Emergency patch, immediate remediation |
| **P1 - High** | CVSS ≥ 9.0 OR (CVSS ≥ 7.0 AND EPSS ≥ 0.1) | 7 days | Prioritize in sprint, patch ASAP |
| **P2 - Medium** | CVSS 7.0-8.9 OR EPSS ≥ 0.05 | 30 days | Normal sprint planning |
| **P3 - Low** | CVSS 4.0-6.9, EPSS < 0.05 | 90 days | Backlog, address in maintenance |
| **P4 - Info** | CVSS < 4.0 | No SLA | Track, address opportunistically |

**Example Prioritization:**

```yaml
# Vulnerability 1: Log4Shell (CVE-2021-44228)
CVSS: 10.0
EPSS: 0.975 (97.5% probability)
KEV: Yes (CISA KEV)
Asset: Critical (payment API)
Exposure: Internet-facing

Priority Score = (10 × 0.3) + (97.5 × 0.3) + (50) + (1 × 0.2) + (1 × 0.2)
                = 3 + 29.25 + 50 + 0.2 + 0.2 = 82.65
Priority: P0 - Critical (SLA: 24 hours)

# Vulnerability 2: Low-severity npm advisory
CVSS: 5.0
EPSS: 0.001 (0.1% probability)
KEV: No
Asset: Medium (internal tool)
Exposure: Internal only

Priority Score = (5 × 0.3) + (0.1 × 0.3) + (0) + (0.4 × 0.2) + (0.5 × 0.2)
                = 1.5 + 0.03 + 0 + 0.08 + 0.1 = 1.71
Priority: P3 - Low (SLA: 90 days)
```

**Tools for Automation:**

- **EPSS API:** https://api.first.org/data/v1/epss
- **KEV Catalog:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- **CVSS Calculator:** NVD, vendor advisories

---

### Framework 4: CI/CD Security Gate Strategy

**Progressive Security Gates:**

**Stage 1: Pre-Commit (Developer Workstation)**

```yaml
Tools: Secret scanning (Gitleaks), SAST (Semgrep)
Action: Warn developer, prevent commit
Threshold: Fail on high-confidence secrets, critical SAST findings
```

**Stage 2: Pull Request (CI Pipeline)**

```yaml
Tools: SAST, SCA, Secret scanning
Action: Block PR merge, require fixes
Threshold:
  - No Critical or High vulnerabilities
  - No secrets
  - SAST findings reviewed
```

**Stage 3: Build (CI Pipeline)**

```yaml
Tools: Container scanning (Trivy), SBOM generation
Action: Fail build, generate artifacts
Threshold:
  - No Critical vulnerabilities in production dependencies
  - SBOM generated and stored
  - Dependency licenses compliant
```

**Stage 4: Pre-Deployment (Staging)**

```yaml
Tools: DAST, Integration tests
Action: Gate deployment to production
Threshold:
  - No Critical or High DAST findings
  - API security validated
  - Authentication/authorization tested
```

**Stage 5: Production (Runtime)**

```yaml
Tools: Runtime monitoring, continuous scanning
Action: Alert, auto-remediate if possible
Threshold:
  - New CVEs in deployed images → Alert + plan patch
  - Anomalous behavior → Investigate
```

**Threshold Configuration Example:**

```yaml
# .trivy.yaml
severity: HIGH,CRITICAL
exit-code: 1  # Fail build
ignore-unfixed: true  # Only fail on fixable vulnerabilities

# Exceptions for known false positives
ignorefile: .trivyignore
```

**Balance Speed and Security:**

- **Fast Feedback:** Unit-test-like experience (< 5 minutes for PR checks)
- **Progressive Depth:** Deeper scans in later stages (DAST in staging, not PR)
- **Fail Fast:** Catch critical issues early (secrets, high CVSS)
- **Baseline + Drift:** Establish baseline, fail on regressions

---

## Scanning Tool Implementations

### Trivy (Primary Recommendation)

**Overview:**

Trivy is the most comprehensive open-source security scanner for containers, filesystems, and repositories. Maintained by Aqua Security, it's fast, accurate, and covers multiple vulnerability types.

**Library:** `/websites/trivy_dev` (Context7)
**Trust Score:** High
**Code Snippets:** 2,133+
**GitHub Stars:** 20K+

**Strengths:**

- **Comprehensive Coverage:** OS packages, language packages, secrets, misconfigurations, licenses
- **Fast:** Scans in seconds, parallel scanning
- **Easy to Use:** Single binary, no complex setup
- **SBOM Support:** Generate and consume CycloneDX and SPDX SBOMs
- **CI/CD Native:** Plugins for GitHub Actions, GitLab CI, CircleCI
- **Multiple Targets:** Container images, filesystems, Git repos, Kubernetes manifests, Terraform

**When to Use:**

- Default choice for container scanning
- Projects needing comprehensive security coverage
- Teams prioritizing speed and ease of use
- CI/CD pipelines (fast feedback)
- Kubernetes environments (manifest scanning)

**Installation:**

```bash
# macOS
brew install trivy

# Linux
curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin

# Docker
docker pull aquasec/trivy:latest
```

**Basic Usage:**

```bash
# Scan container image
trivy image alpine:latest

# Scan with severity filter
trivy image --severity HIGH,CRITICAL alpine:latest

# Generate SBOM (CycloneDX)
trivy image --format cyclonedx --output sbom.json alpine:latest

# Scan SBOM
trivy sbom sbom.json

# Scan filesystem
trivy fs /path/to/project

# Scan Kubernetes manifest
trivy config deployment.yaml

# Scan with exit code (fail on HIGH/CRITICAL)
trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest
```

**GitHub Actions Integration:**

```yaml
name: Trivy Scan

on: [push, pull_request]

jobs:
  trivy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build Docker image
        run: docker build -t myapp:${{ github.sha }} .

      - name: Run Trivy scan
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: myapp:${{ github.sha }}
          format: sarif
          output: trivy-results.sarif
          severity: HIGH,CRITICAL
          exit-code: 1

      - name: Upload results to GitHub Security
        uses: github/codeql-action/upload-sarif@v2
        if: always()
        with:
          sarif_file: trivy-results.sarif
```

**Advanced Configuration (.trivy.yaml):**

```yaml
# Severity filtering
severity: HIGH,CRITICAL

# Exit code (fail build)
exit-code: 1

# Ignore unfixed vulnerabilities
ignore-unfixed: true

# Vulnerability types
vuln-type: os,library

# Skip directories
skip-dirs:
  - node_modules
  - vendor
  - test

# Ignore file
ignorefile: .trivyignore

# SBOM generation
sbom:
  format: cyclonedx
  output: sbom.json
```

**Ignore File (.trivyignore):**

```
# False positives
CVE-2023-12345

# Accepted risks (with justification)
CVE-2023-67890  # Risk accepted: Not exploitable in our use case

# Development dependencies (non-production)
CVE-2023-11111  # Dev dependency, not in production image
```

---

### Grype (Alternative - Accuracy Focus)

**Overview:**

Grype is a vulnerability scanner by Anchore, designed as a simplified successor to Anchore Engine. It focuses on accuracy and minimal false positives.

**Library:** `/anchore/grype` (Context7)
**Trust Score:** High
**Code Snippets:** 94+
**GitHub Stars:** 7K+

**Strengths:**

- **Accuracy:** Precise package version matching, minimal false positives
- **Syft Integration:** Works with Syft for SBOM generation
- **Lightweight:** Simple CLI, no database required
- **Fast:** Comparable to Trivy

**When to Use:**

- Projects sensitive to false positives
- SBOM-first workflows (generate with Syft, scan with Grype)
- Accuracy over comprehensiveness
- Complement to Trivy (second opinion)

**Installation:**

```bash
# macOS
brew install grype

# Linux
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin

# Docker
docker pull anchore/grype:latest
```

**Basic Usage:**

```bash
# Scan container image
grype alpine:latest

# Scan directory
grype dir:path/to/project

# Scan SBOM
grype sbom:./sbom.json

# Pipe SBOM from Syft
syft alpine:latest -o json | grype

# Scan with severity filter
grype alpine:latest --fail-on high

# Exclude paths
grype dir:. --exclude './node_modules/**'
```

**Syft + Grype Workflow:**

```bash
# Generate SBOM with Syft
syft alpine:latest -o cyclonedx-json=sbom.json

# Scan SBOM with Grype
grype sbom:sbom.json

# Combined pipeline
syft alpine:latest -o json | grype --fail-on critical
```

**GitHub Actions Integration:**

```yaml
name: Grype Scan

on: [push, pull_request]

jobs:
  grype:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build image
        run: docker build -t myapp:latest .

      - name: Scan with Grype
        uses: anchore/scan-action@v3
        with:
          image: myapp:latest
          fail-build: true
          severity-cutoff: high

      - name: Upload results
        uses: github/codeql-action/upload-sarif@v2
        if: always()
        with:
          sarif_file: ${{ steps.scan.outputs.sarif }}
```

**Important Note:** Grype had a credential disclosure vulnerability (CVE-2025-65965) in versions 0.68.0-0.104.0. **Use version 0.104.1 or later.**

---

### Snyk Container (Commercial Alternative)

**Overview:**

Snyk Container is a developer-first container security platform with excellent CI/CD integration and remediation guidance.

**Strengths:**

- **Developer Experience:** Clear fix guidance, base image recommendations
- **CI/CD Integration:** Native plugins for all major CI/CD platforms
- **Priority Intelligence:** Risk-based prioritization with exploit maturity
- **Remediation PRs:** Automated pull requests for fixes
- **Comprehensive:** Container, SCA, SAST, IaC in one platform

**When to Use:**

- Organizations willing to invest in commercial tooling
- Teams needing developer-friendly UX
- Projects requiring automated remediation
- Unified security platform (container + dependencies + code)

**Basic Usage:**

```bash
# Install Snyk CLI
npm install -g snyk

# Authenticate
snyk auth

# Scan container image
snyk container test alpine:latest

# Monitor image (track in Snyk dashboard)
snyk container monitor alpine:latest --project-name=myapp

# Test and generate SBOM
snyk container test alpine:latest --json | snyk-to-html -o report.html
```

---

## SBOM Patterns

### SBOM Generation Tools

**Multi-Language SBOM Generators:**

| Tool | Formats | Languages | Strengths |
|------|---------|-----------|-----------|
| **Trivy** | CycloneDX, SPDX | All (container images) | Comprehensive, fast |
| **Syft** | CycloneDX, SPDX | Python, Go, Java, JS, PHP, Rust | Accurate, Anchore ecosystem |
| **cdxgen** | CycloneDX | 20+ languages | OWASP official, multi-language |
| **Microsoft SBOM Tool** | SPDX 2.2 | Multi-language | Enterprise-focused |

**Language-Specific Tools:**

| Language | Tool | Format |
|----------|------|--------|
| **Node.js** | npm-sbom | CycloneDX, SPDX |
| **Python** | cdxgen, pip-audit | CycloneDX |
| **Java** | CycloneDX Maven Plugin | CycloneDX |
| **Go** | syft, cdxgen | CycloneDX, SPDX |
| **Rust** | cargo-sbom | CycloneDX, SPDX |

**Container-Specific:**

| Tool | Best For |
|------|----------|
| **Trivy** | All-in-one (scan + SBOM) |
| **Syft** | SBOM generation (pair with Grype for scanning) |
| **Tern** | Dockerfiles and container layers |

---

### SBOM Generation Patterns

**Pattern 1: CI/CD SBOM Generation (Recommended)**

```yaml
# .github/workflows/sbom.yml
name: Generate SBOM

on:
  push:
    branches: [main]
  release:
    types: [published]

jobs:
  sbom:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build Docker image
        run: docker build -t myapp:${{ github.sha }} .

      - name: Generate SBOM with Trivy (CycloneDX)
        run: |
          trivy image \
            --format cyclonedx \
            --output sbom-cyclonedx.json \
            myapp:${{ github.sha }}

      - name: Generate SBOM with Syft (SPDX)
        run: |
          syft myapp:${{ github.sha }} \
            -o spdx-json=sbom-spdx.json

      - name: Upload SBOMs as artifacts
        uses: actions/upload-artifact@v3
        with:
          name: sboms
          path: |
            sbom-cyclonedx.json
            sbom-spdx.json

      - name: Store SBOM in registry (OCI artifact)
        run: |
          # Using ORAS to attach SBOM to image
          oras attach myregistry.io/myapp:${{ github.sha }} \
            --artifact-type application/vnd.cyclonedx+json \
            sbom-cyclonedx.json:application/vnd.cyclonedx+json
```

**Pattern 2: Multi-Stage SBOM (Build-time + Runtime)**

```dockerfile
# Dockerfile with SBOM generation
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --production

# Generate SBOM during build
RUN npx @cyclonedx/cyclonedx-npm \
    --output-file /tmp/sbom.json \
    --output-format JSON

FROM node:20-alpine AS runtime
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /tmp/sbom.json /app/sbom.json
COPY . .
CMD ["node", "index.js"]
```

**Pattern 3: SBOM Consumption and Scanning**

```yaml
# Scan SBOM instead of image (faster in CI/CD)
name: SBOM Scan

on: [pull_request]

jobs:
  sbom-scan:
    runs-on: ubuntu-latest
    steps:
      - name: Download SBOM from previous build
        uses: actions/download-artifact@v3
        with:
          name: sboms

      - name: Scan SBOM with Trivy
        run: trivy sbom sbom-cyclonedx.json --severity HIGH,CRITICAL

      - name: Scan SBOM with Grype
        run: grype sbom:sbom-cyclonedx.json --fail-on high
```

---

### SBOM Storage and Distribution

**Best Practices:**

1. **Version Control:** Store SBOMs alongside source code in Git
2. **Artifact Repositories:** Upload to Artifactory, Nexus, or cloud storage
3. **OCI Registries:** Attach SBOMs to container images as OCI artifacts
4. **SBOM Platforms:** Use Dependency Track, Kusari, or Sonatype SBOM Manager
5. **Customer Distribution:** Provide SBOMs for compliance and audits

**Storage Example (Dependency Track):**

```bash
# Upload SBOM to Dependency Track
curl -X PUT \
  "https://dtrack.example.com/api/v1/bom" \
  -H "X-Api-Key: $API_KEY" \
  -H "Content-Type: application/json" \
  -d @sbom-cyclonedx.json
```

---

## Vulnerability Prioritization

### CVSS (Common Vulnerability Scoring System)

**CVSS v3.1 Metrics:**

**Base Score (Intrinsic Characteristics):**

- **Attack Vector (AV):** Network, Adjacent, Local, Physical
- **Attack Complexity (AC):** Low, High
- **Privileges Required (PR):** None, Low, High
- **User Interaction (UI):** None, Required
- **Scope (S):** Unchanged, Changed
- **Impact (CIA):** Confidentiality, Integrity, Availability (None, Low, High)

**Severity Ranges:**

- **Critical:** 9.0 - 10.0
- **High:** 7.0 - 8.9
- **Medium:** 4.0 - 6.9
- **Low:** 0.1 - 3.9
- **None:** 0.0

**Limitations:**

- Doesn't reflect actual exploitation in the wild
- Static score, doesn't adapt to threat landscape
- All Critical CVEs treated equally (not all are equally dangerous)

---

### EPSS (Exploit Prediction Scoring System)

**What is EPSS?**

EPSS predicts the probability that a vulnerability will be exploited within the next 30 days, based on:

- Exploit availability (PoC, Metasploit modules)
- Public discussions and mentions
- Vulnerability age and characteristics
- Historical exploitation patterns

**EPSS Score Interpretation:**

- **0.9 - 1.0:** Very high probability (>90%)
- **0.5 - 0.9:** High probability
- **0.1 - 0.5:** Moderate probability
- **0.0 - 0.1:** Low probability

**Using EPSS:**

```bash
# Fetch EPSS score via API
curl https://api.first.org/data/v1/epss?cve=CVE-2021-44228

# Response:
{
  "cve": "CVE-2021-44228",
  "epss": 0.97505,
  "percentile": 0.99999
}
```

**Integration Example:**

```python
import requests

def get_epss_score(cve_id):
    """Fetch EPSS score for a CVE"""
    url = f"https://api.first.org/data/v1/epss?cve={cve_id}"
    response = requests.get(url)
    data = response.json()
    if data['data']:
        return float(data['data'][0]['epss'])
    return 0.0

# Prioritize vulnerabilities
vulnerabilities = [
    {"cve": "CVE-2021-44228", "cvss": 10.0},
    {"cve": "CVE-2023-12345", "cvss": 9.0}
]

for vuln in vulnerabilities:
    vuln['epss'] = get_epss_score(vuln['cve'])
    vuln['priority'] = calculate_priority(vuln)
```

---

### KEV (Known Exploited Vulnerabilities) Catalog

**What is KEV?**

CISA's catalog of CVEs that are actively being exploited in the wild. If a CVE is in the KEV catalog, it requires **immediate action**.

**KEV Catalog URL:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog

**KEV Criteria:**

1. CVE assigned by NVD
2. Documented exploit in the wild
3. Clear remediation action available

**Using KEV:**

```bash
# Download KEV catalog
curl -o kev.json https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json

# Check if CVE is in KEV
jq '.vulnerabilities[] | select(.cveID == "CVE-2021-44228")' kev.json
```

**KEV Integration Example:**

```python
import requests

def is_in_kev(cve_id):
    """Check if CVE is in CISA KEV catalog"""
    url = "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
    response = requests.get(url)
    kev_data = response.json()

    for vuln in kev_data['vulnerabilities']:
        if vuln['cveID'] == cve_id:
            return True
    return False

# Flag KEV vulnerabilities for immediate action
if is_in_kev("CVE-2021-44228"):
    print("P0 - Critical: CVE in KEV catalog, patch immediately")
```

---

## Implementation Patterns

### Pattern 1: Multi-Stage Scanning Pipeline

```yaml
# .github/workflows/security-scan.yml
name: Security Scan Pipeline

on:
  pull_request:
  push:
    branches: [main]

jobs:
  # Stage 1: Secret Scanning (Fast)
  secrets:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Scan for secrets
        uses: trufflesecurity/trufflehog@main
        with:
          path: ./
          base: ${{ github.event.pull_request.base.sha }}
          head: ${{ github.sha }}
          extra_args: --only-verified

  # Stage 2: SAST (Fast)
  sast:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Semgrep Scan
        uses: semgrep/semgrep-action@v1
        with:
          config: >-
            p/security-audit
            p/secrets
            p/owasp-top-ten

  # Stage 3: SCA (Moderate)
  sca:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Dependency Review
        uses: actions/dependency-review-action@v3
        with:
          fail-on-severity: high

  # Stage 4: Container Scan (Moderate)
  container:
    runs-on: ubuntu-latest
    needs: [secrets, sast, sca]  # Run after fast checks
    steps:
      - uses: actions/checkout@v4

      - name: Build image
        run: docker build -t myapp:${{ github.sha }} .

      - name: Trivy scan
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: myapp:${{ github.sha }}
          format: sarif
          output: trivy-results.sarif
          severity: HIGH,CRITICAL
          exit-code: 1

      - name: Generate SBOM
        run: |
          trivy image \
            --format cyclonedx \
            --output sbom.json \
            myapp:${{ github.sha }}

      - name: Upload SBOM
        uses: actions/upload-artifact@v3
        with:
          name: sbom
          path: sbom.json

  # Stage 5: DAST (Slow - only on main)
  dast:
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    needs: container
    steps:
      - uses: actions/checkout@v4

      - name: Deploy to staging
        run: ./deploy-staging.sh

      - name: OWASP ZAP Scan
        uses: zaproxy/action-baseline@v0.7.0
        with:
          target: https://staging.example.com
          fail_action: true
```

---

### Pattern 2: Vulnerability Remediation Workflow

```yaml
# .github/workflows/vuln-remediation.yml
name: Vulnerability Remediation

on:
  schedule:
    - cron: '0 0 * * *'  # Daily
  workflow_dispatch:

jobs:
  scan-and-remediate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Scan for vulnerabilities
        id: scan
        run: |
          trivy image myapp:latest --format json --output scan.json

      - name: Parse scan results
        id: parse
        run: |
          # Extract fixable high/critical vulnerabilities
          jq '.Results[].Vulnerabilities[] | select(.Severity == "HIGH" or .Severity == "CRITICAL") | select(.FixedVersion != "")' scan.json > fixable.json

      - name: Generate remediation PR
        if: steps.parse.outputs.fixable_count > 0
        run: |
          # Update dependencies
          ./update-dependencies.sh

          # Create PR
          gh pr create \
            --title "Security: Fix ${{ steps.parse.outputs.fixable_count }} vulnerabilities" \
            --body "Automated vulnerability remediation" \
            --label "security,automated"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

---

### Pattern 3: Policy-as-Code with OPA

```rego
# policy/vulnerability.rego
package vulnerability

# Deny if any Critical vulnerabilities found
deny[msg] {
    input.Vulnerabilities[_].Severity == "CRITICAL"
    msg := "Critical vulnerabilities detected"
}

# Deny if High vulnerabilities in production dependencies
deny[msg] {
    input.Vulnerabilities[i].Severity == "HIGH"
    input.Vulnerabilities[i].PkgName
    not contains(input.Vulnerabilities[i].PkgName, "devDependencies")
    msg := sprintf("High vulnerability in production: %v", [input.Vulnerabilities[i].PkgName])
}

# Warn if unfixed vulnerabilities
warn[msg] {
    input.Vulnerabilities[i].FixedVersion == ""
    msg := sprintf("Unfixed vulnerability: %v", [input.Vulnerabilities[i].VulnerabilityID])
}

# Deny if KEV catalog vulnerability
deny[msg] {
    input.Vulnerabilities[i].VulnerabilityID
    is_in_kev(input.Vulnerabilities[i].VulnerabilityID)
    msg := sprintf("KEV catalog vulnerability: %v - immediate remediation required", [input.Vulnerabilities[i].VulnerabilityID])
}
```

**Using OPA with Trivy:**

```bash
# Scan and evaluate policy
trivy image myapp:latest --format json | opa eval --data policy/ --input - 'data.vulnerability.deny'
```

---

## Tool Recommendations

### Research Summary

**Research Date:** December 3, 2025
**Tools Evaluated:** 15+
**Research Tools:** Google Search Grounding, Context7

---

### Container Scanning Tools (2025)

#### **Primary: Trivy** (Comprehensive, Open-Source)

**Library:** `/websites/trivy_dev` (Context7), `/aquasecurity/trivy` (GitHub)
**Trust Score:** High
**Code Snippets:** 2,133+ (Context7)
**GitHub Stars:** 20K+
**Maintainer:** Aqua Security

**Why Trivy?**

- **Comprehensive:** OS packages, language packages, secrets, misconfigurations, licenses
- **Fast:** 10x faster than legacy scanners, parallel processing
- **Easy:** Single binary, zero setup, works out-of-the-box
- **SBOM Native:** Generate and consume CycloneDX/SPDX
- **CI/CD Ready:** Plugins for all major platforms
- **Active Development:** 100+ releases/year, responsive maintainers

**When to Use:**

- Default choice for container scanning
- Comprehensive security coverage needed
- Fast CI/CD pipelines (< 1 minute scans)
- Kubernetes environments (manifest scanning)
- Teams needing all-in-one solution

**Installation:**

```bash
brew install trivy  # macOS
curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh  # Linux
```

**Example:**

```bash
# Scan image
trivy image --severity HIGH,CRITICAL alpine:latest

# Generate SBOM
trivy image --format cyclonedx --output sbom.json alpine:latest

# Scan filesystem
trivy fs --scanners vuln,secret,misconfig .
```

---

#### **Alternative: Grype** (Accuracy-Focused)

**Library:** `/anchore/grype` (Context7)
**Trust Score:** High
**Code Snippets:** 94+
**GitHub Stars:** 7K+
**Maintainer:** Anchore

**Why Grype?**

- **Accuracy:** Minimal false positives, precise matching
- **Syft Integration:** Pair with Syft for SBOM generation
- **Lightweight:** No database, fast startup
- **CLI-First:** Simple, composable

**When to Use:**

- False positive sensitivity
- SBOM-first workflows (Syft → Grype)
- Second opinion validation
- CI/CD with existing Anchore tooling

**Important:** Use v0.104.1+ (credential disclosure CVE-2025-65965 patched)

**Installation:**

```bash
brew install grype
```

**Example:**

```bash
# Scan with Grype
grype alpine:latest --fail-on high

# SBOM workflow
syft alpine:latest -o json | grype
```

---

#### **Commercial: Snyk Container**

**Strengths:**

- Developer-first UX, clear remediation guidance
- Automated remediation PRs
- Priority Intelligence (exploit maturity)
- Unified platform (container + SCA + SAST + IaC)

**When to Use:**

- Budget for commercial tooling
- Developer productivity priority
- Automated remediation needed
- Unified security platform desired

---

### SBOM Generation Tools

| Tool | Formats | Best For |
|------|---------|----------|
| **Trivy** | CycloneDX, SPDX | All-in-one (scan + SBOM) |
| **Syft** | CycloneDX, SPDX | SBOM accuracy, Anchore ecosystem |
| **cdxgen** | CycloneDX | Multi-language projects, OWASP official |
| **Microsoft SBOM Tool** | SPDX 2.2 | Enterprise Windows environments |

**Recommendation:** Trivy (comprehensive) or Syft (accuracy-focused)

---

### SAST Tools

| Tool | Type | Best For |
|------|------|----------|
| **Semgrep** | Open-source | Fast, customizable, multi-language |
| **Snyk Code** | Commercial | IDE integration, developer-first |
| **SonarQube** | Commercial | Enterprise code quality + security |
| **GitLab SAST** | Built-in | GitLab users (native integration) |

**Recommendation:** Semgrep (open-source), Snyk Code (commercial)

---

### DAST Tools

| Tool | Type | Best For |
|------|------|----------|
| **OWASP ZAP** | Open-source | Full-featured, mature |
| **StackHawk** | Commercial | Modern CI/CD native |
| **Burp Suite** | Commercial | Manual + automated testing |

**Recommendation:** OWASP ZAP (open-source), StackHawk (CI/CD focus)

---

### SCA Tools

| Tool | Best For |
|------|----------|
| **Dependabot** | GitHub users (native, free) |
| **Renovate** | Advanced automation, multi-platform |
| **Snyk Open Source** | Comprehensive commercial solution |
| **OWASP Dependency-Check** | Open-source, multi-language |

**Recommendation:** Dependabot (GitHub) or Renovate (advanced)

---

### Secret Scanning

| Tool | Best For |
|------|----------|
| **Gitleaks** | Open-source, fast, configurable |
| **TruffleHog** | Open-source, entropy detection |
| **GitGuardian** | Commercial, real-time protection |
| **GitHub Secret Scanning** | GitHub users (native) |

**Recommendation:** Gitleaks (open-source), GitGuardian (commercial)

---

## Skill Structure Design

### Skill File Organization

**Proposed Structure:**

```
vulnerability-management/
├── SKILL.md                          # Main skill file (<500 lines)
├── references/
│   ├── tool-selection.md             # Which tool for which use case
│   ├── sbom-guide.md                 # CycloneDX vs SPDX, generation, management
│   ├── prioritization-framework.md   # CVSS + EPSS + KEV formulas
│   ├── ci-cd-patterns.md             # GitHub Actions, GitLab CI, Jenkins
│   ├── remediation-workflows.md      # SLA tracking, false positives
│   └── policy-as-code.md             # OPA examples, security gates
├── examples/
│   ├── trivy/
│   │   ├── basic-scan.sh             # Simple image scan
│   │   ├── sbom-generation.sh        # SBOM generation and scanning
│   │   ├── github-actions.yml        # CI/CD integration
│   │   └── config-trivy.yaml         # Advanced configuration
│   ├── grype/
│   │   ├── basic-scan.sh
│   │   ├── syft-integration.sh       # Syft + Grype workflow
│   │   └── github-actions.yml
│   ├── ci-cd/
│   │   ├── github-actions-multi-stage.yml
│   │   ├── gitlab-ci-security.yml
│   │   ├── jenkins-pipeline.groovy
│   │   └── azure-pipelines.yml
│   ├── sbom/
│   │   ├── generate-cyclonedx.sh
│   │   ├── generate-spdx.sh
│   │   └── dependency-track-upload.sh
│   └── prioritization/
│       ├── epss-integration.py
│       ├── kev-checker.py
│       └── priority-calculator.py
└── scripts/
    ├── vulnerability-report.sh       # Generate executive reports
    ├── sla-tracker.sh                # Track remediation SLAs
    └── false-positive-manager.sh     # Manage suppression rules
```

---

### SKILL.md Structure (Main File)

**Sections (Target: ~450 lines):**

1. **Frontmatter** (YAML)
   - name, description

2. **Purpose** (2-3 paragraphs)
   - What this skill teaches
   - When to use this skill

3. **Multi-Layer Scanning Overview** (~80 lines)
   - Container scanning (Trivy, Grype)
   - SAST, DAST, SCA, Secrets
   - Quick decision tree

4. **SBOM Generation** (~60 lines)
   - CycloneDX vs. SPDX
   - Tools (Trivy, Syft)
   - Basic generation examples

5. **Vulnerability Prioritization** (~80 lines)
   - CVSS basics
   - EPSS and KEV integration
   - Priority scoring formula

6. **CI/CD Integration** (~100 lines)
   - GitHub Actions example
   - Multi-stage pipeline pattern
   - Security gates and thresholds

7. **Tool Quick Reference** (~60 lines)
   - Trivy (primary)
   - Grype (alternative)
   - When to use which tool

8. **Reference Links** (~20 lines)
   - Links to detailed references/
   - Links to examples/

---

### Progressive Disclosure Strategy

**Main SKILL.md Contains:**

- High-level decision frameworks
- Quick-start examples (minimal)
- When to use each tool
- Links to detailed references

**References/ Contains:**

- Detailed tool selection guide (references/tool-selection.md)
- Comprehensive SBOM patterns (references/sbom-guide.md)
- Full prioritization framework (references/prioritization-framework.md)
- Advanced CI/CD patterns (references/ci-cd-patterns.md)

**Examples/ Contains:**

- Working scripts (copy-paste ready)
- Complete CI/CD configurations
- Real-world scenarios

**Scripts/ Contains:**

- Reporting automation
- SLA tracking
- Metrics generation

---

## Integration Points

### Integration with Existing Skills

#### 1. **building-ci-pipelines** Skill

- **Security Stages:** Add vulnerability scanning to pipeline stages
- **Artifacts:** SBOM storage and distribution
- **Quality Gates:** Fail builds on critical vulnerabilities
- **Reporting:** Security metrics in pipeline dashboards

**Example Integration:**

```yaml
# Security stage in CI/CD pipeline
security-scan:
  stage: security
  image: aquasec/trivy:latest
  script:
    - trivy image --severity HIGH,CRITICAL --exit-code 1 $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA
  artifacts:
    reports:
      container_scanning: gl-container-scanning-report.json
```

---

#### 2. **secret-management** Skill

- **Secret Scanning:** Prevent secrets in code (Gitleaks, TruffleHog)
- **Integration:** Pre-commit hooks, CI/CD checks
- **Remediation:** Rotate leaked secrets automatically

**Example Integration:**

```yaml
# Pre-commit hook
- repo: https://github.com/gitleaks/gitleaks
  rev: v8.18.0
  hooks:
    - id: gitleaks
```

---

#### 3. **infrastructure-as-code** Skill

- **IaC Scanning:** Trivy config scanning for Terraform, Kubernetes manifests
- **Misconfigurations:** Detect insecure configurations before deployment
- **Policy Enforcement:** OPA policies for infrastructure

**Example Integration:**

```bash
# Scan Terraform
trivy config --severity HIGH,CRITICAL terraform/

# Scan Kubernetes manifests
trivy config --severity HIGH,CRITICAL k8s/
```

---

#### 4. **security-hardening** Skill

- **Remediation Guidance:** Fixing vulnerabilities found by scanners
- **Base Image Selection:** Choosing secure base images
- **Security Best Practices:** Implementing secure coding patterns

**Example Integration:**

- Vulnerability scan identifies outdated dependency
- Security-hardening skill provides upgrade guidance
- CI/CD pipeline validates fix with re-scan

---

#### 5. **compliance-frameworks** Skill

- **SBOM for Compliance:** Generating SBOMs for audits (SOC2, ISO 27001)
- **Vulnerability Tracking:** Evidence for security controls
- **Reporting:** Vulnerability metrics for compliance reports

**Example Integration:**

```bash
# Generate compliance report
trivy image --format json myapp:latest | \
  jq '[.Results[].Vulnerabilities[] | {cve: .VulnerabilityID, severity: .Severity, status: .Status}]' > compliance-report.json
```

---

### Integration with External Systems

**1. Slack/Teams Notifications:**

```yaml
- name: Notify on critical vulnerabilities
  if: failure()
  uses: 8398a7/action-slack@v3
  with:
    status: ${{ job.status }}
    text: 'Critical vulnerabilities found in ${{ github.repository }}'
    webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

**2. Jira Integration (Automated Ticket Creation):**

```bash
# Create Jira ticket for critical vulnerabilities
curl -X POST https://jira.example.com/rest/api/2/issue \
  -H "Content-Type: application/json" \
  -d '{
    "fields": {
      "project": {"key": "SEC"},
      "summary": "Critical vulnerability: CVE-2023-12345",
      "description": "Found in myapp:latest",
      "issuetype": {"name": "Security"}
    }
  }'
```

**3. Dependency Track Integration:**

```bash
# Upload SBOM to Dependency Track
curl -X PUT "https://dtrack.example.com/api/v1/bom" \
  -H "X-Api-Key: $API_KEY" \
  -H "Content-Type: application/json" \
  -d @sbom.json
```

---

## Implementation Roadmap

### Phase 1: Foundation (Week 1)

**Deliverables:**

- [x] Complete init.md (this document)
- [ ] Create SKILL.md main file
- [ ] Write references/tool-selection.md
- [ ] Write references/sbom-guide.md

**Content Focus:**

- Tool selection decision frameworks
- SBOM fundamentals (CycloneDX vs. SPDX)
- Basic scanning workflows

---

### Phase 2: Container Scanning (Week 2)

**Deliverables:**

- [ ] Complete Trivy examples
- [ ] Complete Grype examples
- [ ] Write references/prioritization-framework.md

**Files:**

- examples/trivy/basic-scan.sh
- examples/trivy/sbom-generation.sh
- examples/trivy/github-actions.yml
- examples/grype/basic-scan.sh
- examples/grype/syft-integration.sh

---

### Phase 3: CI/CD Integration (Week 3)

**Deliverables:**

- [ ] GitHub Actions examples
- [ ] GitLab CI examples
- [ ] Jenkins pipeline example
- [ ] Write references/ci-cd-patterns.md

**Files:**

- examples/ci-cd/github-actions-multi-stage.yml
- examples/ci-cd/gitlab-ci-security.yml
- examples/ci-cd/jenkins-pipeline.groovy

---

### Phase 4: Prioritization & Remediation (Week 4)

**Deliverables:**

- [ ] EPSS integration examples
- [ ] KEV checker script
- [ ] Priority calculator
- [ ] Write references/remediation-workflows.md

**Files:**

- examples/prioritization/epss-integration.py
- examples/prioritization/kev-checker.py
- examples/prioritization/priority-calculator.py

---

### Phase 5: Advanced Topics (Week 5)

**Deliverables:**

- [ ] Policy-as-code examples (OPA)
- [ ] False positive management
- [ ] Write references/policy-as-code.md

**Files:**

- examples/opa/vulnerability-policy.rego
- scripts/false-positive-manager.sh

---

### Phase 6: Polish & Integration (Week 6)

**Deliverables:**

- [ ] Create scripts/vulnerability-report.sh
- [ ] Create scripts/sla-tracker.sh
- [ ] Cross-link with related skills
- [ ] Test all examples

---

## Validation Checklist

### Before Creating SKILL.md

- [x] Research complete (Google Search + Context7)
- [x] Tool recommendations validated (Trivy, Grype trust scores)
- [x] Decision frameworks designed
- [x] SBOM patterns identified
- [x] Integration points with other skills mapped

### Before Finalizing Skill

- [ ] SKILL.md under 500 lines
- [ ] All references/ files created
- [ ] All examples/ working and tested
- [ ] Progressive disclosure effective
- [ ] Scripts functional
- [ ] Integration with related skills verified

---

## Success Metrics

**This skill is successful if developers can:**

1. **Select Tools:**
   - Choose Trivy vs. Grype vs. Snyk based on needs
   - Select appropriate scanning layers (container, SAST, DAST, SCA)

2. **Generate SBOMs:**
   - Create CycloneDX or SPDX SBOMs
   - Integrate SBOM generation into CI/CD
   - Store and distribute SBOMs

3. **Prioritize Vulnerabilities:**
   - Apply CVSS + EPSS + KEV prioritization
   - Implement risk-based SLAs
   - Focus on high-risk vulnerabilities first

4. **Integrate into CI/CD:**
   - Add security scanning to pipelines
   - Implement security gates (fail builds on critical)
   - Automate SBOM generation

5. **Track and Remediate:**
   - Monitor vulnerability SLAs
   - Manage false positives
   - Generate compliance reports

---

## Future Enhancements

**Potential Additions (Not in Initial Release):**

1. **Advanced DAST Patterns**
   - API security testing (OWASP API Top 10)
   - Authentication testing automation
   - GraphQL security scanning

2. **Runtime Vulnerability Management**
   - IAST (Interactive Application Security Testing)
   - Runtime monitoring integration
   - Live patching strategies

3. **AI-Powered Prioritization**
   - ML models for risk prediction
   - Automated remediation suggestions
   - Vulnerability trend analysis

4. **Advanced SBOM Management**
   - SBOM diff analysis (track changes)
   - License compliance automation
   - Supply chain risk scoring

5. **Compliance Automation**
   - SOC2 evidence generation
   - ISO 27001 vulnerability control mapping
   - PCI-DSS vulnerability scanning requirements

---

## Appendix: Tool Comparison Matrix

### Container Scanning Tools

| Tool | License | Speed | Coverage | SBOM | CI/CD | Best For |
|------|---------|-------|----------|------|-------|----------|
| **Trivy** | Apache 2.0 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | Yes (CycloneDX, SPDX) | ⭐⭐⭐⭐⭐ | Most projects |
| **Grype** | Apache 2.0 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | Via Syft | ⭐⭐⭐⭐ | Accuracy focus |
| **Snyk** | Commercial | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | Yes | ⭐⭐⭐⭐⭐ | Enterprise |

---

### SBOM Tools

| Tool | Formats | Languages | Speed | Best For |
|------|---------|-----------|-------|----------|
| **Trivy** | CycloneDX, SPDX | All (containers) | ⭐⭐⭐⭐⭐ | All-in-one |
| **Syft** | CycloneDX, SPDX | Multi-language | ⭐⭐⭐⭐⭐ | Accuracy |
| **cdxgen** | CycloneDX | 20+ languages | ⭐⭐⭐⭐ | Multi-language |

---

## References

**Research Sources:**

- Google Search Grounding: Container scanning, SBOM, SAST/DAST, prioritization
- Context7: Trivy (/websites/trivy_dev), Grype (/anchore/grype)
- Official Documentation: Trivy.dev, Anchore Grype, CISA KEV, FIRST.org EPSS
- Industry Standards: NTIA SBOM, OWASP Top 10, CycloneDX, SPDX

**Related Skills:**

- `building-ci-pipelines` - CI/CD integration
- `secret-management` - Secret scanning and rotation
- `infrastructure-as-code` - IaC security scanning
- `security-hardening` - Remediation guidance
- `compliance-frameworks` - SBOM for audits

---

**Document Status:** ✅ Complete
**Next Step:** Create SKILL.md from this master plan
**Owner:** AI Design Components Project
**Last Updated:** December 3, 2025
